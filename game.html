<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Game Dev 1 Project 2</title>
        
        <script type="text/javascript" src="lib/phaser/build/phaser.min.js"></script>

    </head>
    <body>

    <script type="text/javascript">

    window.onload = function() {

        var game = new Phaser.Game(1334, 750, Phaser.AUTO, '', { preload: preload, create: create, update: update });


        var player;
        var dragMagnitude = 500;
        var boatSpeed = 400;

        function preload () {

            //load images
            game.load.image('player', 'assets/sprites/player.png');
        }

        function create () {
            //load arcade phsycis
            game.physics.startSystem(Phaser.Physics.ARCADE);

            game.stage.backgroundColor = '#0072bc';

            //make a player thing
            player = game.add.sprite(200,200, 'player');

            game.physics.enable(player, Phaser.Physics.ARCADE);
            
            player.anchor.setTo(0.5,0.5);

            player.body.collideWorldBounds = true;

            player.body.drag.x = Math.sqrt(2) * dragMagnitude;
            player.body.drag.y = Math.sqrt(2) * dragMagnitude;


        }


        function update(){

            //do something with the drag somehow
            if(player.body.velocity)
            //game.time.elapsed
            
            if(game.input.activePointer.leftButton.isDown ){

                //move player towards mouse button
                game.physics.arcade.moveToPointer(player, Math.min(400, Math.pow(game.physics.arcade.distanceToPointer(player), 2)));
                
                //game.physics.accelerateToPointer(player, this.game.input.activePointer, 600, 100, 100);
            } else{
                var velocityMagnitude = Math.sqrt(player.body.velocity.x * player.body.velocity.x + player.body.velocity.y * player.body.velocity.y);
                //if boat is moving with some amount of speed
                if(velocityMagnitude < 10){
                    player.body.drag.x = Math.sqrt(2) * dragMagnitude;
                    player.body.drag.y = Math.sqrt(2) * dragMagnitude;
                } else{
                    //vector stuff
                    player.body.drag.x = Math.abs(player.body.velocity.x / velocityMagnitude * dragMagnitude);
                    player.body.drag.y = Math.abs(player.body.velocity.y / velocityMagnitude * dragMagnitude);

                }
            }
        }

    };

    </script>

    </body>
</html>